From 804330749cf17f2c96b2fd31b18495b6e55e6e47 Mon Sep 17 00:00:00 2001
From: Nishidha Panpaliya <npanpa23@in.ibm.com>
Date: Wed, 9 Mar 2022 07:44:29 -0500
Subject: [PATCH] Build llvm for ppc64le target

---
 third_party/llvm/macos_build_fix.patch | 23 +++++++++++++----------
 1 file changed, 13 insertions(+), 10 deletions(-)

diff --git a/third_party/llvm/macos_build_fix.patch b/third_party/llvm/macos_build_fix.patch
index 4dba8676ea5..99d5981a1f8 100644
--- a/third_party/llvm/macos_build_fix.patch
+++ b/third_party/llvm/macos_build_fix.patch
@@ -1,15 +1,15 @@
-From 7b4ce5b36f6fc0e35c3614861d394b9f48d950a4 Mon Sep 17 00:00:00 2001
-From: Dan F-M <foreman.mackey@gmail.com>
-Date: Wed, 27 Oct 2021 21:44:40 -0400
-Subject: [PATCH] Adding macos darwin config
+From 2e6bbdf4bc7e03fc874239e11cd1f73f5b2655e4 Mon Sep 17 00:00:00 2001
+From: Nishidha Panpaliya <npanpa23@in.ibm.com>
+Date: Wed, 9 Mar 2022 07:42:49 -0500
+Subject: [PATCH] LLVM macos patch plus ppc64le
 
 ---
  utils/bazel/llvm-project-overlay/llvm/BUILD.bazel | 8 ++++++++
- utils/bazel/llvm-project-overlay/llvm/config.bzl  | 4 ++--
- 2 files changed, 10 insertions(+), 2 deletions(-)
+ utils/bazel/llvm-project-overlay/llvm/config.bzl  | 5 +++--
+ 2 files changed, 11 insertions(+), 2 deletions(-)
 
 diff --git a/utils/bazel/llvm-project-overlay/llvm/BUILD.bazel b/utils/bazel/llvm-project-overlay/llvm/BUILD.bazel
-index 3e8bbe8a1cc1..8883b16b7350 100644
+index 7c31359fb4ed..1aafa5d4ee0e 100644
 --- a/utils/bazel/llvm-project-overlay/llvm/BUILD.bazel
 +++ b/utils/bazel/llvm-project-overlay/llvm/BUILD.bazel
 @@ -16,6 +16,14 @@ package(
@@ -28,10 +28,10 @@ index 3e8bbe8a1cc1..8883b16b7350 100644
  # The necessary warnings and other compile flags should be provided by the
  # toolchain or the `.bazelrc` file. This is just a workaround until we have a
 diff --git a/utils/bazel/llvm-project-overlay/llvm/config.bzl b/utils/bazel/llvm-project-overlay/llvm/config.bzl
-index ff64df694048..c9c35b01711c 100644
+index 2046b2645362..9ed63e8d44a3 100644
 --- a/utils/bazel/llvm-project-overlay/llvm/config.bzl
 +++ b/utils/bazel/llvm-project-overlay/llvm/config.bzl
-@@ -76,8 +76,8 @@ os_defines = select({
+@@ -83,9 +83,10 @@ os_defines = select({
  # TODO: We should split out host vs. target here.
  llvm_config_defines = os_defines + select({
      "@bazel_tools//src/conditions:windows": native_arch_defines("X86", "x86_64-pc-win32"),
@@ -40,7 +40,10 @@ index ff64df694048..c9c35b01711c 100644
 +    "//llvm:macos_arm64": native_arch_defines("AArch64", "arm64-apple-darwin"),
 +    "@bazel_tools//src/conditions:darwin": native_arch_defines("X86", "x86_64-unknown-darwin"),
      "@bazel_tools//src/conditions:linux_aarch64": native_arch_defines("AArch64", "aarch64-unknown-linux-gnu"),
++    "@bazel_tools//src/conditions:linux_ppc64le": native_arch_defines("PowerPC", "powerpc64le-unknown-linux-gnu"),
      "//conditions:default": native_arch_defines("X86", "x86_64-unknown-linux-gnu"),
  }) + [
+     # These shouldn't be needed by the C++11 standard, but are for some
 -- 
-2.30.1 (Apple Git-130)
+2.23.0
+
-- 
2.23.0

