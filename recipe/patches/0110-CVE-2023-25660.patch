From e98437b3e02111ebf2439699af9772f63cbb0298 Mon Sep 17 00:00:00 2001
From: Mihai Maruseac <mihaimaruseac@google.com>
Date: Thu, 19 Jan 2023 17:31:46 -0800
Subject: [PATCH] Quick fix for a vuln in printing empty tensors.

PiperOrigin-RevId: 503308327
---
 tensorflow/core/framework/tensor.cc | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/tensorflow/core/framework/tensor.cc b/tensorflow/core/framework/tensor.cc
index ca3930e85ca..7a6007d69c3 100644
--- a/tensorflow/core/framework/tensor.cc
+++ b/tensorflow/core/framework/tensor.cc
@@ -1224,6 +1224,9 @@ template <>
 string SummarizeArray<bool>(int64_t limit, int64_t num_elts,
                             const TensorShape& tensor_shape, const char* data,
                             const bool print_v2) {
+  if (data == nullptr) {
+    return strings::StrCat("");  // we already print type and shape
+  }
   // We first convert all chars to be 0/1 to not get InvalidEnumValue sanitizer
   // error
   auto mutable_data = std::unique_ptr<char[]>(new char[num_elts]);
-- 
2.34.1

